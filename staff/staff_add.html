<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>添加员工</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" type="text/css" href="../css/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="../css/management_table.css"/>
	</head>
	<body>
		<div class="layui-fluid">
			<div class="layui-row">
				<div class="layui-card">
					<div class="layui-card-header">
						<a href="staff.html" class="list-nav"><i class="layui-icon layui-icon-left"></i>员工管理</a> 
						<span lay-separator="">/</span>
						<a><cite>添加员工</cite></a>
					</div>
					<div class="layui-card-body">
						<form class="layui-form">
							<h6>基本信息</h6>
							<div class="layui-form-item">
								<label class="layui-form-label">员工姓名</label>
								<div class="layui-input-inline">
									<input type="text" name="stame" lay-verify="required|title" autocomplete="off" class="wd250 l_left layui-input" >
									<span class="Validform_checktip"> </span>
								</div>
							</div>
							<div class="layui-form-item" >
								<label class="layui-form-label">员工级别</label>
								<div class="layui-input-inline">
									<select id="pid" lay-filter="test" lay-verify="required" name="pid"  >
										<option value="" selected="selected">请选择</option>
									
									</select>
								</div>
							</div>
							<div class="layui-form-item" id="ridno">
								<label class="layui-form-label">所属上级</label>
								<div class="layui-input-inline">
									<select id="RId" name="RId"  >
										<option value="0" selected="selected">请选择</option>
									</select>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">登录账号</label>
								<div class="layui-input-inline">
									<input type="text" name="stount" lay-verify="required|content" autocomplete="off" class="layui-input wd250 l_left" />
									<span class="Validform_checktip">*登录账号必须为手机号</span>
								</div>
							</div>
							<div class="layui-form-item">
                                <label class="layui-form-label">登录密码</label>
                                <div class="layui-input-inline">
                                    <input type="text" id="seo_keywords" lay-verify="password" name="pard" class=" wd250 l_left layui-input">
                                    <span class="Validform_checktip">*密码必须以字母开头包含数字并且要高于6位</span>
                                </div>
							</div>
							<div class="layui-form-item" >
                                <label class="layui-form-label">账户状态</label>
                                <div class="layui-input-block">
                                    <input type="radio" name="is_lock" value="0" title="正常" checked="">
                                    <input type="radio" name="is_lock" value="1" title="禁用">
                                </div>
							</div>
							<hr>
							<h6>员工提成</h6>
							<div class="layui-form-item">
									<label class="layui-form-label l_width">开仓服务费提成</label>
									<div class="layui-input-inline">
										<input type="text"  name="rabuy" id="rabuy" lay-verify="required|number" autocomplete="off" class="layui-input wd250 l_left"  lay-verify="zznumber"/>
										<span class="Validform_checktip">*元/张</span>
									</div>
								</div>
								<div class="layui-form-item">
									<label class="layui-form-label l_width">平仓服务费提成</label>
									<div class="layui-input-inline">
										<input type="text" name="ratale" lay-verify="required"  id="ratale|number" autocomplete="off" class="layui-input wd250 l_left"  lay-verify="zznumber"/>
										<span class="Validform_checktip">*元/张</span>
									</div>
								</div>
								<div class="layui-form-item">
									<label class="layui-form-label l_width">追加延期服务费提成</label>
									<div class="layui-input-inline">
										<input type="text" name="ratlay"  lay-verify="required|number"  id="ratlay"autocomplete="off" class="layui-input wd250 l_left"  lay-verify="zznumber"/>
										<span class="Validform_checktip">*元/张</span>
									</div>
								</div>
								<hr>
							<h6>联系方式</h6>
							<div class="layui-form-item">
								<label class="layui-form-label">QQ</label>
								<div class="layui-input-inline">
									<input type="text" id="co_qq"  lay-verify="required|number"  name="co_qq" class="wd250 l_left layui-input" >
									<span class="Validform_checktip"> </span>
								</div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">手机</label>
                                <div class="layui-input-inline">
									<input type="text" id="conbile"  lay-verify="required|phone" name="conbile" class="wd250 l_left layui-input">
									<span class="Validform_checktip"> </span>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">微信</label>
                                <div class="layui-input-inline">
									<input type="text" id="conchat" ata-valid="isNonEmpty"  lay-verify="required" name="conchat" class="wd250 l_left layui-input">
									<span class="Validform_checktip"> </span>
                                </div>
                            </div>
						
                            <div class="layui-form-item layui-form-text">
                                <label class="layui-form-label">备注</label>
                                <div class="layui-input-inline">
                                    <textarea placeholder="请输入内容" class="layui-textarea wd480" name="rerk"ata-valid="isNonEmpty" data-error="备注不能为空" ></textarea>
                                </div>
                            </div>
							<div class="layui-form-item">
								<label class="layui-form-label"></label>
								<div class="layui-input-block">
									<button  type="button" class="layui-btn" lay-submit="" id="sub_btn"  lay-filter="sub_btn">确认提交</button>
									
								</div>
                            </div>
                            
						</form>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script src="../css/layui/layui.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/jquery-3.4.0.min.js"></script>

	

	<script src="../js/public.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
	publicMathod.token = localStorage.getItem('Token') != null ? unescape(localStorage.getItem('Token')) : publicMathod.token;
		layui.use(['form', 'jquery','element'], function() {
			var form = layui.form;
			var $ = layui.jquery;
			var element = layui.element;

				//自定义验证规则
				form.verify({
				title: function(value) {
					if (value.length > 20) {
						return '名字长度不能超过20';
					}
				},
				content: function(value) {
					if (value.length > 11) {
						return '账号长度不能超过11';
					}
				},
				password: function(value) {
                    var par = /^[a-zA-Z]{1}([a-zA-Z0-9]|[._]){5,19}$/;
					if (!par.exec(value)) {
						return '密码必须以字母开头包含数字并且要高于6位';
					}
				}
				
			});
				//获取员工经理枚举
			publicMathod.getDropdownList("api/Tool/GetPlatformEmployeeType", form, $("#pid"));
			// 获取所有经理
			publicMathod.getJingLiList("api/SysStaffList/GetModelJinli", form, $("#RId"));
			// 监听下拉列表选择器如果是经理隐藏归属
			form.on('select(test)', function(data){
				if(data.value == 0) {
					$("#ridno").hide();
				}else{
					$("#ridno").show();
				}
			
			});   
			//监听提交
			var lock = true
			form.on('submit(sub_btn)', function(data) {
				var data = data.field;
				if(lock){
				lock = false
				publicMathod.post({
					url:"api/SysStaffList/Edit",
					data:{
						"id": 0,
						"stame": data.stame,
						"teyp":parseInt(data.pid), 
						"pid": parseInt(data.RId),
						"stount": data.stount,
						"pard": data.pard,
						"is_lock": parseInt(data.is_lock),
						"rabuy": parseFloat(data.rabuy) ,
						"ratale": parseFloat(data.ratale),
						"ratlay": parseFloat(data.ratlay),
						"conbile": data.conbile,
						"conchat": data.conchat,
						"co_qq": data.co_qq,
						"rerk": data.rerk
					},
					success:function(result){
						if(result.Status == 1){
							window.location.href = "staff.html";
						}else{
							lock = true
							layer.msg(result.Msg,{icon:5,shade:0.8,});
						}
					}
				})
				}
				// layedit.getContent(layedit_index); //获得富文本内容包括样式
				// layer.alert(JSON.stringify(data.field), {
					// title: '最终的提交信息'
				// })
				return false;
			});
		})
		
	</script>
</html>
